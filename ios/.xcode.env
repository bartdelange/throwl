# Load nvm (for Xcode / xcodebuild environments)
if [ -s "$HOME/.nvm/nvm.sh" ]; then
  . "$HOME/.nvm/nvm.sh"
elif [ -x "$(command -v brew)" ] && [ -s "$(brew --prefix nvm)/nvm.sh" ]; then
  . "$(brew --prefix nvm)/nvm.sh"
fi

# Use Node version from repo root .nvmrc (one level above ios/)
ROOT_NVMRC="$PROJECT_DIR/../.nvmrc"

if command -v nvm >/dev/null 2>&1 && [ -f "$ROOT_NVMRC" ]; then
  NODE_VER="$(cat "$ROOT_NVMRC" | tr -d ' \t\r\n')"
  nvm use --silent "$NODE_VER" >/dev/null 2>&1 || nvm install "$NODE_VER"
fi

# Export absolute path so RN scripts donâ€™t guess
export NODE_BINARY="$(command -v node)"
